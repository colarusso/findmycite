<!DOCTYPE html>
<HTML xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="http://www.facebook.com/2008/fbml">
  <head>
    <title>Find My Cite (Beta)</title>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	  <meta name="apple-mobile-web-app-capable" content="no" />

    <meta property="og:type" content="website"/>
  	<meta property="og:title" content="Find My Cite"/>
  	<meta property="og:description" content="Are you a Zotero user? Do you ever wish you could search your libraries by idea not keywords? Then this page is for you. Follow the steps below to download a information from one of your group libraries and search it using an "idea" search. That is, we'll match your search with the semantic content of text from your library. That means you don't have to use the exact language found in a text to find a cite."/>
  	<meta property="og:image" content="images/thefuture.png"/>

  	<meta name="twitter:card" content="summary_large_image">
  	<meta name="twitter:site" content="@Colarusso">
  	<meta name="twitter:creator" content="@Colarusso">
  	<meta name="twitter:title" content="Find My Cite">
  	<meta name="twitter:description" content="Are you a Zotero user? Do you ever wish you could search your libraries by idea not keywords? Then this page is for you. Follow the steps below to download a information from one of your group libraries and search it using an "idea" search. That is, we'll match your search with the semantic content of text from your library. That means you don't have to use the exact language found in a text to find a cite.">
  	<meta name="twitter:image" content="http://www.davidcolarusso.com/images/thefuture.png"/>

    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.16.2/axios.min.js"></script>

    <script type="module" src="https://findmycite.org/js/spin.min.js"></script>

    <link rel="stylesheet" type="text/css" href="css/style.css?build=1">
    <script>
      //var server = "http://127.0.0.1:10100"; // Local Testing Server
      var server = "https://tools.suffolklitlab.org"; // Production Server
      var default_group = "4961358";
      var building_lib = 0;
      var last_update;
    </script>
    <script src="js/find.js"></script>
    <script src="js/ask.js"></script>
    <script src="js/suggest.js"></script>

  </head>
  <body onLoad="tab('none');"><form autocomplete="off">
    <div id="msg" style="display:none;top:0;z-index:100;width:100%;margin:0;">
      <div style="margin:15px auto 0 auto;max-width:400px;text-align:center;background:#fff;padding:0px 15px 0 15px;">
      <b> This may take some time. I am currently:</b>
      <p id="output">Thinking...</p>
      </div>
    </div>
    <div id="content" style="margin:15px auto 0 auto;max-width:900px;">

      <div style="float:left;text-align:left"><b>Find My Cite</b> <sup><font color="gray" size=-2>BETA</font></div>
      <div id="menu" style="float:right;display:none;">
        <a id="menu_bs" href="javascript:void('');" onClick="tab('bs');">ü§ñ BS</a>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
        <a id="menu_find" href="javascript:void('');" onClick="tab('find');">Find</a>&nbsp;&nbsp;&nbsp;
        <a id="menu_ask" href="javascript:void('');" onClick="tab('ask');">Ask</a>&nbsp;&nbsp;&nbsp;
        <a id="menu_suggest" href="javascript:void('');" onClick="tab('suggest');">Suggest</a>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
        <a id="menu_settings" href="javascript:void('');" onClick="tab('settings');">Settings</a>
      </div>

      <div id="search_box" style="float:left;width:100%;">

        <hr style="height:1px;border:none;color:#999;background-color:#999;margin:15px 0 0 0;">

        <p style="text-align:center;background:#faef8e;padding:15px;border: 1px solid #888;">FWIW, the builders of this site will discuss it at this year's <a href="https://suffolklitlab.org/LITCon/2023/" target="_blank">Legal Innovation &amp; Technology Conference</a> (April 3, 2023).</p>


        <!---   START BS   -->
        <div id="bs" style="display:none;float:left;width:100%">

          <a name="alogbs"><h2>Algorithmic BS: Exploring Uses of Large Langue Models</h2></a>

          <div class="r_img_embed" style="max-width:350px;">
            <img src="images/robot-bs.png" alt="image of the following emoji: ü§ñ üêÇüí©" width="100%"/>
            <div class="caption">Algorithmic BS?</div>
          </div>
        <p>
          The modern authoritarian practice of ‚Äúflood[ing] the zone with shit‚Äù clearly illustrates the dangers posed by <a href="https://en.wikipedia.org/wiki/Bullshit#Harry_Frankfurt's_concept" target="_blank">bullshitters</a>‚Äîi.e., those who produce plausible sounding speech with no regard for accuracy. Consequently, the broad-based concern expressed over the rise of algorithmic bullshit is both understandable and warranted. Large <a href="https://en.wikipedia.org/wiki/Language_model" target="_blank">language models</a> (LLMs), like those powering <a href="https://en.wikipedia.org/wiki/ChatGPT" target="_blank">ChatGPT</a>, complete text by predicting subsequent words based on patterns present in their training data are, if not the embodiment of such bullshitters, tools ripe for use by such actors. They are by design fixated on producing plausible sounding text, and since they lack understanding of their output, they cannot help but be unconcerned with accuracy. Couple this with the fact that their training texts encode the biases of their authors, and one can find themselves with what some have called <a href="https://octodon.social/@cwebber/109462369670144568" target="_blank">mansplaining as a service</a>.
        </p>
        <p>
          So why did the <a href="https://suffolklitlab.org/" target="_blank">LIT Lab</a> use an LLM to build these tool, and why bother working with a known bullshitter?
        </p>
        <p>
          For one, "algorithmic BS artists" lack agency. They do not understand their input or output. Their "dishonesty" is a consequence of their use case, not their character. Context matters, and tools are not moral actors. Any agency, moral or otherwise, lies with the developers and users of such tools. By stepping into these roles we are exploring the questions that arise when using these tools. Additionally, as educators, it is part of our duty to prepare our students for the realities of a world where such tools exist. To do that we think it's important to understandnot just how they work now but to explore new use cases. The tools presented here are, in part, an attempt to imagine pro-social uses for such technology, ones that don't end in the death of scholarship or truth. In fact, they are attempts to use them for the service of both. Of course, any assement of a tool's use must include the broader context of its use, including its creation. This context raises <a href="https://link.springer.com/article/10.1007/s13347-020-00405-8" target="_blank">just as many questions</a>. Readers can find more discussion of these larger implications at <a href="https://www.codingthelaw.org" target="_blank">Coding The Law.org</a> and see an example of how we've responded to some of them in <a href="https://spot.suffolklitlab.org/trusts/" target="_blank">our prior AI work</a>. Below, however, we will focus on the tools found here on Find My Cite, which largely ask, "can we work with this particular 'bullshitter' (i.e., LLMs)?" 
        </p>
        <p>
          When asked to complete a text prompt, LLMs default to constructing sentences that resemble their training data. This can lead to "confabulations." These models, however, need not operate in isolation. One can work to mitigate the problem of BS by providing context, e.g., by sourcing reliable texts and asking for output based on these. Such is <a href="https://github.com/openai/openai-cookbook/blob/main/examples/Question_answering_using_embeddings.ipynb" target="_blank">the trick</a> used here. We have created a set of tools that asks an LLM (GPT-3) to reorder the contents of an existing Zotero Library. This does not limit the danger posed by such tools <a href="https://www.nytimes.com/2023/01/06/podcasts/transcript-ezra-klein-interviews-gary-marcus.html" target="_blank">driving the cost of BS production to nearly zero</a>, and it does not guarantee accuracy. It does, however, offer an interesting explortion of how LLMs can be used to seach through and texts and provided answers to question and supporting examples. It also couples its output to real cites (from its library) allowing the user to check its work. To help understand more what this means, here's some...
        </p>
        
        <h3><a name="background" href="#background" class="anchor" alt="deep link to this section"></a>Background</h3>
        
        <p>Coming soon...</p>
        <!--
        <p>
          The problem of BS, however, is not the only issue faced by such models. When they allow end-users to provide their own prompts, they are subject to <a href="https://simonwillison.net/2022/Sep/12/prompt-injection/" target="_blank">prompt injection</a>, the careful crafting of inputs to override a tool's original instructions. What could go wrong? <i>Oh no . . . you're going to try this below aren't you?</i>
        </p>
        <p>
          Mostly, we hope you will find this a novel way to engage with the information packet. And, if you would like to get your hands dirty creating, evaluating, and understand the legal implications of such tools, we suggest you consider enrolling in <a href="https://www.codingthelaw.org/" target="_blank">Coding the Law</a> (offered in the fall) or the Legal Innovation & Technology (LIT) Clinic (open to 2Ls and 3Ls). Which brings is to the real reason one might consider working with this particular BS artist‚Äîbecause practice experience working with a tool leads to understanding, and understanding is power. That power is something you can leverage both for the benefit of your clients and practice. We don't expect our students to become production coders, but we'd like them to learn enough to call BS. And yes, this is largely a gimmick to get you interested in the Lab, but we also think it can answer a few of your questions. ;)
        </p>

        <div class="l_img_embed" style="max-width:400px;">
          <img src="images/projection.png" alt="a 2-d projection of embeddings for different new articles which shows clustering by topic" width="100%"/>
          <div class="caption"><a href="https://cloud.google.com/blog/products/ai-machine-learning/problem-solving-with-ml-automatic-document-classification" class="caption">classification</a></div>
        </div>        

          First, this piece on AI + homework has something worth saying: https://stratechery.com/2022/ai-homework/ (namely, we should expect that folks are going to use AI ‚áí plan accordingly. Also it's kind of crap right now)

          Second, it's important to look not just at what this tech can do but also how it was built. See e.g., https://link.springer.com/article/10.1007/s13347-020-00405-8 (providing an exploration of AI practices through a decolonial lens)

          That being said, we have to understand something before we can intelligently talk about it. So, for the moment my goal is explaining #LLMs to #LawProfs

          So, here we go...

          One of the big discoveries of #NLP is the text embedding (a set of numbers produced from text). It turns out that we can turn strings of words into numbers. For example, we can turn any arbitrary set of words into an array of 300 numbers. 

It's hard to visualize, but a list of these numbers correspond to a point in some n-dimensional space (300-D in the case above).

And here's the BFD! We can do this such that strings with similar meanings are close to each other in this n-D space.

If we collect a bunch of texts we can start to create constellations based on these points. Here we see a 2-D shadow (projection) of some higher dimensional space with dots for a bunch of news articles colored by topic.¬π

If we got some new text, computed it's embedding, and plotted that here, we could make a pretty good guess as to what topic it belonged to based on nothing but where it was located. 

----
¬π https://cloud.google.com/blog/products


Enter #ChatGPT. Imagine the point in this space occupied by some text you are typing. 

As you add words, the location of the dot corresponding to your text moves. Since no one word is likely to change its meaning much, it won't move around too much, but you can see how with each new word it moves towards or away from one of the constellations defined by other texts.

When you let a tool like an #LLM complete text for you it's like that point is drawn towards the texts (dots) it already knows about, as if by gravity. These are the texts it was trained on. The position changes as the text grows. The truth of this new text is not a consideration, only that it looks like (gets close to) texts it knows.

This is why folks like @cwebber have called these tools "mansplaining as a service."¬π

-------
¬π See https://octodon.social/@cwebber/109462

Armed with the gravity metaphor we can now ask questions like, "How do we get an #LLM to answer accurately?" A few ideas come immediately to mind.

1. Only fill the space with texts (dots)  that are true (i.e., retrain the model).

2. Add in/identify some texts that we know are true and have them exert a greater pull (i.e., tune the model)

3. Craft the start of your prompt such that it anchors and/or directs the dot's subsequent motion towards parts of space associated with trusted texts.

The idea of only using trusted texts in the original training runs into the problem that you need a LOT of texts. That's because what #LLMs are really "learning" is what sentences look like from a statistical standpoint. Of course, you can think carefully about how you source texts. See e.g., https://pile.eleuther.ai/

As with training/retraining, tuning a model can be computationally expensive... 

Can you tell that I really want to talk about what's behind door number three?

In case it wasn't clear, when you ask an #LLM a question, all it is doing is suggesting the next set of words in a string of text. It seems like an answer, but it's just an exercise in adding new words (drifting towards the pull of known texts). Because LLMs care about the whole (or most) of the string, you can anchor them in particular places.

Consider:

Instead of having an #LLM add to the sentence "What is the best sports town in the US?" what if you provided the prompt "Boston is the home of Red Sox Nation, the best sports city in the US. "What is the best sports town in the US?" As you might guess if you seed the prompt with the "right" answer, you drastically up the chance of it answering correctly. So how do we seed the A to a Q? Presumably, we're asking the Q because we don't know the A. Well...

What if you use the query (e.g., "What is...?") to perform a traditional search then use the results of that search to seed the prompt to an #LLM & ask it not to answer if the ans isn't in the seed? It turns out this works pretty well & you can show your sources. 

Here's a bot I built that uses a single document to source trusted texts (chunks of the doc) for the construction of a seeded prompt. Basically, it lets you talk with an information packet. 

https://suffolklitlab.org/bs

And there's no reason we have to limit this approach to questioning a text. We could just as easily create an anchor for more traditional text completion. E.g., Complete the following paragraph using only information found in "the seed."

Anywho, I think I have what I need for the faculty meeting. Mostly, I've realized I have too much to fit into my allotted time.

I saw @design_law fave an earlier post. Maybe I can just direct folks to this thread. ;)

h/t @simon for the seed idea.


          <h3><a name="tools" href="#tools" class="anchor" alt="deep link to this section"></a>The Tools Found Here</h3>

          <h3><a name="find_descript" href="#find_descript" class="anchor" alt="deep link to this section"></a>Find</h3>

          <h3><a name="ask_descript" href="#ask_descript" class="anchor" alt="deep link to this section"></a>Ask</h3>

          <h3><a name="suggest_descript" href="#suggest_descript" class="anchor" alt="deep link to this section"></a>Suggest</h3>
--->

          </div>
      </div>
      <!---   END BS   -->

      <!---   START TERMS   -->
      <div id="tos" style="display:none;float:left;width:100%">

        <a name="terms"><h2>Terms</h2></a>

        <p>Coming soon...</p>

      </div>
      <!---   END TERMS   -->

        <div id="find" style="float:left;width:100%;display:none;">

          <a name="search"><h2>Find a proposition in your <a href="javascript:void('');" onClick="tab('settings');">library</a></h2></a>

          <div style="float:left;margin-right:45px;margin-bottom:20px;">
            <input type="checkbox" id="suggest" name="suggest" value="1" CHECKED>
            <label for="suggest"> Auto suggest (shows up to 5 matching texts from your library)</label>
          </div>
          <div style="float:left;margin-bottom:20px;">
            Cosine Similarity Cutoff: <span id="cutoffv">0.7</span></br>
            <input type="range" min="0.5" max="1" step="0.01" value="0.7" id="cutoff" oninput="$('#cutoffv').html(this.value);" style="width:200px;">
          </div>
          <div style="float:left;width:100%;margin:0px 0 0px 0;">
            <table><tr><td width="100%">
              <div class="autocomplete" style="width:100%;">
                <input id="q" type="text" name="q" placeholder="The proposition you wish to cite" style="width:100%;height:43px;font-size:15px;padding:10px;box-sizing: border-box;border-radius: 5px; border: solid 1px #5e5e5e;resize:none;">
              </div>
            </td><td width="50px">
              <input type="button" class="ai_button" style="width:100px;" value='Find' onclick="test_understanding(document.getElementById('q').value,localStorage.group)"/>
            </td></tr></table>
            <div id="output" style="float:left;width:100%;">
            <div id="loading" style="display:none;float:left;width:100%;height: 60px; margin: 25px 0;text-align:center;"></div>
            <p id="answer" style="margin:0px;float:left;width:100%;"></p>
            </div>
          </div>
        </div>

        <div id="startup" style="float:left;width:100%;text-align:center;background:yellow;padding:10px 0;margin:15px 0;">
          Loading...
        </div>


        <!---   START ASK   -->
        <div id="ask" style="display:none;float:left;width:100%">

          <a name="ask"><h2>Ask a question of your <a href="javascript:void('');" onClick="tab('settings');">library</a></h2></a>

          <textarea name='question' id="question" style="width:100%;height:80px;font-size:15px;padding:5px;box-sizing: border-box;border-radius: 5px; border: solid 1px #5e5e5e;resize:none;" maxlength="500" placeholder="Ask your question here"></textarea>

          <div style="padding:5px 0 8px 0;"><span class="subtitle"></span></div>

          <p style="margin:0px 0px 5px 0px;">
            <input type="button" class="ai_button" value="Ask" onCLick="ask($('#question').val(),localStorage.group);"/>
          </p>

          <div id="output_ask" style="float:left;width:100%;">

            <div id="loading_ask" style="display:none;width:100%;margin:50px auto;text-align:center;">
              <img src="images/Ajax-loader.gif" width="35px;" height="35px;"/>
            </div>
            <div id="response_ask" style="float:left;display:none;width:100%;margin:0px auto 0px 0px;"></div>

          </div>
      </div>
      <!---   END ASK   -->


      <!---   START COMPLET   -->
      <div id="complete" style="display:none;float:left;width:100%;">

        <a name="suggest"><h2>Suggest text supported by your <a href="javascript:void('');" onClick="tab('settings');">library</a></h2></a>

        <textarea name='seed' id="seed" style="width:100%;height:250px;font-size:15px;padding:5px;box-sizing: border-box;border-radius: 5px; border: solid 1px #5e5e5e;resize:none;" maxlength="500" placeholder="Start a paragraph here"></textarea>

        <div style="padding:5px 0 8px 0;"><span class="subtitle"></span></div>

        <p style="margin:0px 0px 5px 0px;">
          <input type="button" class="ai_button" value="Suggest" onCLick="com_par($('#seed').val(),localStorage.group);"/>
        </p>

        <div id="output_complete" style="float:left;width:100%;">

          <div id="loading_complete" style="display:none;width:100%;margin:50px auto;text-align:center;">
            <img src="images/Ajax-loader.gif" width="35px;" height="35px;"/>
          </div>
          <div id="response_complete" style="float:left;display:none;width:100%;margin:0px auto 0px 0px;"></div>

        </div>
    </div>
    <!---   END COMPLETE   -->


    <!---   START LIBRARY   -->
    <div id="library" style="display:none;float:left;width:100%">

    <!--
      <a name="library"><h2>Performance</h2></a>
    <p>
      asdjahsl daskl dhlaskhdl
    </p>
    <input type="checkbox" id="boost" name="boost" value="1" CHECKED>
    <label for="boost"> Boost performance for the <i>Ask</i> and <i>Suggest</i> features (nearly doubles runtime)</label>
    -->

    <a name="library"><h2>My Zotero Library</h2></a>
    <p>
      <b>Loading a Group.</b> Find My Cite helps you interact with existing <a href="https://www.zotero.org/support/groups" target="_blank">Zotero groups</a>. If someone (like a teacher or colleauge) directed you here with a group number, enter it below and click the "Update Group" button. For you to interact with a group's texts it must first be synced with Find My Cite. See below. Additionally, you can only view the fulltext of documents in a group if you are a member of the group. If you aren't a member, you may be able to view the citation information depending on the group's type (e.g., if it is <i>Public, Closed Membership</i>, non-members can see citation information).
    </p>
    <p>
      Zotero Group: <input id="group" style="border:1px solid #aaa;padding:5px;box-sizing: border-box; font-size:15px;width:100px;" value="4935168" onkeyup="update_preview()">
      &nbsp;
      <input id="update" type="button" value="Update Group" style="padding:5px;font-size:15px;" onClick="localStorage.group = $('#group').val();location.reload();"/>
      &nbsp;
      <input id="deafult" type="button" value="Restore Default" style="padding:5px;font-size:15px;" onClick="localStorage.group = '';location.reload();"/>
    </p>
    <p style="font-size:14px;">
      Visit Group: <a id="preview" href="https://www.zotero.org/groups/" target="_blank">https://www.zotero.org/groups/</a>
    </p>
    <p>
      <b>Synchronizing a Group.</b> To synchronize a group, you will need: (1) a Zotero API Key with access to said group; and (2) a Find My Cite Key. These are random strings of letters and numbers that act like passwords. You can make a Zotero API Key by following <a href="https://www.zotero.org/settings/keys/new" target="_blank">these instructions</a>. And you can ask for a Find My Cite Key by emailing the LIT Lab at <a href="mailto:litlab@suffolk.edu">litlab@suffolk.edu</a>. However, we're only giving out a very very limited number at this time. Also, for now, we're only synchronizing up to 500 items per group (including attachments).
    </p>
    <p>
      After you synchronize a group anyone with the group's number can interact with its texts via the tools here (i.e., <a href="javascript:void('');" onClick="tab('find');">find</a>, <a href="javascript:void('');" onClick="tab('ask');">ask</a>, &amp; <a href="javascript:void('');" onClick="tab('suggest');">suggest</a>). <span style="background:#faef8e">They will not be able to see the original documents unless you also make them a member of the group and have <a href="https://www.zotero.org/storage" target="_blank">document storage</a> turned on in Zotero.</span> The group number is the string of numbers in the URL between <i>/groups/</i> and your group's name. For example, <i>8675309</i> is the ID found in the following url: <i>https://www.zotero.org/groups/8675309/library_name/</i>.
    </p>
    <p>
      Zotero API-Key: &nbsp;<input id="api_key" style="border:1px solid #aaa;padding:5px;box-sizing: border-box; font-size:15px;width:150px;" type="password" onchange="localStorage.api_key = $('#api_key').val();"/>
      &nbsp;
      <select id="bib" style="padding:5px;font-size:15px;">
        <option value="apa">American Psychological Association 7th edition</option>
        <option value="bluebook-law-review" SELECTED>Bluebook Law Review</option>
        <!--<option value="https://our.law.nagoya-u.ac.jp/updater/styles/jm-indigobook-law-review.csl">IndigoBook (Law Review)</option>-->
        <option value="chicago-note-bibliography">Chicago Manual of Style 17th edition (note)</option>
        <option value="modern-language-association">Modern Language Association 8th edition</option>
      </select>
    </p>
    <p>
      FindMyCite Key: <input id="cite_key" style="border:1px solid #aaa;padding:5px;box-sizing: border-box; font-size:15px;width:150px;" type="password" onchange="localStorage.cite_key = $('#cite_key').val();"/>
      &nbsp;
      <input id="build_button" type="button" value="Sync Library" style="padding:5px;font-size:15px;" onClick="localStorage.group = $('#group').val();build($('#group').val(),$('#api_key').val(),$('#cite_key').val(),$('#bib').val())"/>
      &nbsp;&nbsp;<span id="last_synced">Last Synced: </span>
    </p>
    </p>
      <div id="show_when_building" style="display:none;">
        <h3>This could take a while...</h3>
        <p>This can take a while, like go get and drink a whole cup of coffee-a-while. ‚òï <i>Note: The larger your library, the longer it will take. The first sync will likely take the longest as susequent syncs will try to focus only on changes.</i></p>
        <div id="loading_lib" style="float:left;width:100%;height: 60px; margin: 25px 0;text-align:center;"></div>
      </div>
      <div id="texts_in_lib">
        <h3>Texts in your library:</h3>
        <p>
          We can only provide information from those texts highlighted in <span style='background:#aef7a6'>light green</span>. You may be able to turn more of them green by doing one of two things: (1) if you don't have a copy of the document in your Zotero library, add it and sync above; (2) re-building your Zotero library index and syncing above once it is complete. See <a href="https://www.zotero.org/support/preferences/search">Zotero Search</a> (including discussion of how to rebuild your Full-Text Cache). Find My Cite leverages your fulltext index, which only includes text files, pdfs, and webpage snapshots at this time.  
        </p>
        <ol id="lib_links">
        </ol>
      </div>
    </div>
    <!---   END LIBRARY   -->



    <div style="width:100%;float:left;margin-top:20px;">
      <hr style="height:1px;border:none;color:#999;background-color:#999;">
      <p style='text-align:center;margin-bottom:400px;text-align:right;font-size:14px;padding:5px 10px;'>
        <a href="https://suffolklitlab.org/" alt="LIT Lab" target="_blank"><img src="https://suffolklitlab.org/images/blue_logo.png" width="50px" align="left" border="0" alt="LIT Logo"/></a>
        <a id="tos" href="javascript:void('');" onClick="tab('tos');" style="text-transform: uppercase;font-size:12px;">Terms &amp; Privacy</a> | <a id="og" href="original/" style="text-transform: uppercase;font-size:12px;">Original Site</a>
      </p>
    </div>


  </form></body>
  <script>
    function tab(choice){

      if ((choice=="none") && (localStorage.tab)) {
        choice = localStorage.tab;
      } else if (choice=="none") {
        choice = "bs";
      }

      localStorage.tab = choice;

      $('#startup').hide();
      $('#menu').show();

      if (choice=="bs") {
        $('#bs').show();
        $('#library').hide();
        $('#find').hide();
        $('#ask').hide();
        $('#complete').hide();
        $('#tos').hide();
        $('#menu_bs').css('text-decoration', 'none');
        $('#menu_bs').css('font-weight', '600');
        $('#menu_bs').css('color', 'black');
        $('#menu_find').css('text-decoration', 'underline');
        $('#menu_find').css('font-weight', '100');
        $('#menu_find').css('color', 'blue');
        $('#menu_ask').css('text-decoration', 'underline');
        $('#menu_ask').css('font-weight', '100');
        $('#menu_ask').css('color', 'blue');
        $('#menu_suggest').css('text-decoration', 'underline');
        $('#menu_suggest').css('font-weight', '100');
        $('#menu_suggest').css('color', 'blue');
        $('#menu_settings').css('text-decoration', 'underline');
        $('#menu_settings').css('font-weight', '100');
        $('#menu_settings').css('color', 'blue');
        $('#q').focus();
      } else if ((choice=="find") && (building_lib==0)) {
        $('#bs').hide();
        $('#library').hide();
        $('#find').show();
        $('#ask').hide();
        $('#complete').hide();
        $('#tos').hide();
        $('#menu_bs').css('text-decoration', 'underline');
        $('#menu_bs').css('font-weight', '100');
        $('#menu_bs').css('color', 'blue');
        $('#menu_find').css('text-decoration', 'none');
        $('#menu_find').css('font-weight', '600');
        $('#menu_find').css('color', 'black');
        $('#menu_ask').css('text-decoration', 'underline');
        $('#menu_ask').css('font-weight', '100');
        $('#menu_ask').css('color', 'blue');
        $('#menu_suggest').css('text-decoration', 'underline');
        $('#menu_suggest').css('font-weight', '100');
        $('#menu_suggest').css('color', 'blue');
        $('#menu_settings').css('text-decoration', 'underline');
        $('#menu_settings').css('font-weight', '100');
        $('#menu_settings').css('color', 'blue');
        $('#q').focus();
      } else if ((choice=="ask") && (building_lib==0)) {
        $('#bs').hide();
        $('#library').hide();
        $('#find').hide();
        $('#ask').show();
        $('#complete').hide();
        $('#tos').hide();
        $('#menu_bs').css('text-decoration', 'underline');
        $('#menu_bs').css('font-weight', '100');
        $('#menu_bs').css('color', 'blue');
        $('#menu_find').css('text-decoration', 'underline');
        $('#menu_find').css('font-weight', '100');
        $('#menu_find').css('color', 'blue');
        $('#menu_ask').css('text-decoration', 'none');
        $('#menu_ask').css('font-weight', '600');
        $('#menu_ask').css('color', 'black');
        $('#menu_suggest').css('text-decoration', 'underline');
        $('#menu_suggest').css('font-weight', '100');
        $('#menu_suggest').css('color', 'blue');
        $('#menu_settings').css('text-decoration', 'underline');
        $('#menu_settings').css('font-weight', '100');
        $('#menu_settings').css('color', 'blue');
        $('#question').focus();
      } else if ((choice=="suggest") && (building_lib==0)) {
        $('#bs').hide();
        $('#library').hide();
        $('#find').hide();
        $('#ask').hide();
        $('#complete').show();
        $('#tos').hide();
        $('#menu_bs').css('text-decoration', 'underline');
        $('#menu_bs').css('font-weight', '100');
        $('#menu_bs').css('color', 'blue');
        $('#menu_find').css('text-decoration', 'underline');
        $('#menu_find').css('font-weight', '100');
        $('#menu_find').css('color', 'blue');
        $('#menu_ask').css('text-decoration', 'underline');
        $('#menu_ask').css('font-weight', '100');
        $('#menu_ask').css('color', 'blue');
        $('#menu_suggest').css('text-decoration', 'none');
        $('#menu_suggest').css('font-weight', '600');
        $('#menu_suggest').css('color', 'black');
        $('#menu_settings').css('text-decoration', 'underline');
        $('#menu_settings').css('font-weight', '100');
        $('#menu_settings').css('color', 'blue');
        $('#seed').focus();
      } else if (choice=="settings") {
        $('#bs').hide();
        $('#library').show();
        $('#find').hide();
        $('#ask').hide();
        $('#complete').hide();
        $('#tos').hide();
        $('#menu_bs').css('text-decoration', 'underline');
        $('#menu_bs').css('font-weight', '100');
        $('#menu_bs').css('color', 'blue');
        $('#menu_find').css('text-decoration', 'underline');
        $('#menu_find').css('font-weight', '100');
        $('#menu_find').css('color', 'blue');
        $('#menu_ask').css('text-decoration', 'underline');
        $('#menu_ask').css('font-weight', '100');
        $('#menu_ask').css('color', 'blue');
        $('#menu_suggest').css('text-decoration', 'underline');
        $('#menu_suggest').css('font-weight', '100');
        $('#menu_suggest').css('color', 'blue');
        $('#menu_settings').css('text-decoration', 'none');
        $('#menu_settings').css('font-weight', '600');
        $('#menu_settings').css('color', 'black');
      } else if (choice=="tos") {
        $('#bs').hide();
        $('#library').hide();
        $('#find').hide();
        $('#ask').hide();
        $('#complete').hide();
        $('#tos').show();
        $('#menu_bs').css('text-decoration', 'underline');
        $('#menu_bs').css('font-weight', '100');
        $('#menu_bs').css('color', 'blue');
        $('#menu_find').css('text-decoration', 'underline');
        $('#menu_find').css('font-weight', '100');
        $('#menu_find').css('color', 'blue');
        $('#menu_ask').css('text-decoration', 'underline');
        $('#menu_ask').css('font-weight', '100');
        $('#menu_ask').css('color', 'blue');
        $('#menu_suggest').css('text-decoration', 'underline');
        $('#menu_suggest').css('font-weight', '100');
        $('#menu_suggest').css('color', 'blue');
        $('#menu_settings').css('text-decoration', 'underline');
        $('#menu_settings').css('font-weight', '100');
        $('#menu_settings').css('color', 'blue');
      } else if (building_lib==1) {
        alert("This feature is unavailable as we are still syncronizing your library. ");
      } else if (building_lib==-1) {
        alert("We can't find a Zotero group associated with the number you have provided. To use this tool, please 'Sync Library' to link the group, or enter another value. ");
      }
    }

    if (localStorage.cite_key) {
      document.getElementById('cite_key').value = localStorage.cite_key;
    }
    if (localStorage.group) {
      document.getElementById('group').value = localStorage.group;
    } else {
      localStorage.group = default_group
      document.getElementById('group').value = localStorage.group;
    }
    if (localStorage.api_key) {
      document.getElementById('api_key').value = localStorage.api_key;
    }
    if (localStorage.cutoff) {
      document.getElementById('cutoff').value = localStorage.cutoff;
      $('#cutoffv').html(localStorage.cutoff);
    }

    $('#q').keypress(function(e){
    if(e.keyCode == 13 && !e.shiftKey && Boolean($('#qautocomplete-list').html()=="" | !$('#qautocomplete-list').html()) ) {
      e.preventDefault();
      test_understanding(document.getElementById('q').value,localStorage.group);
     }
    });

    $('#question').keypress(function(e){
    if(e.keyCode == 13 && !e.shiftKey) {
      e.preventDefault();
      ask($('#question').val(),localStorage.group);
     }
    });

    $('#seed').keypress(function(e){
    if(e.keyCode == 13 && !e.shiftKey) {
      e.preventDefault();
      com_par($('#seed').val(),localStorage.group);
     }
    });

  </script>
  <script type="text/javascript"> 
    //var JSLink = "js/data_lib.js?version=" + localStorage.group;
    var JSLink = server+"/lib_js/?g=" +localStorage.group + "&version=" + Math.random();

    get_build(localStorage.group);
    
    var JSElement = document.createElement('script');
    JSElement.id = "lib_et_al"; 
    JSElement.src = JSLink;
    JSElement.onload = OnceLoaded;
    document.getElementsByTagName('head')[0].appendChild(JSElement);

    function OnceLoaded() {
      if (lib.length>0) {
        //SentVecs = Object.assign({}, SentVecs_01,SentVecs_02,SentVecs_03,SentVecs_04,SentVecs_05);
        autocomplete(document.getElementById("q"), Object.values(SentTexts));
        update_texts();
      } else {
        building_lib = -1;
        $('#lib_links').html("<p style='background:yellow;padding:15px;'>We can't find a Zotero group associated with the number you have provided. To use this tool, please 'Sync Library' to link the group, or enter another value. FWIW, you can reload the default library by inputing "+ default_group +".</p>");
        $("#group").css("background-color","red"); 
      }
      update_preview();
    }
  </script>
</html>
