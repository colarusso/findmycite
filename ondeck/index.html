<!DOCTYPE html>
<HTML xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="http://www.facebook.com/2008/fbml">
  <head>
    <title>Find My Cite (Beta)</title>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	  <meta name="apple-mobile-web-app-capable" content="no" />

    <meta property="og:type" content="website"/>
  	<meta property="og:title" content="Find My Cite"/>
  	<meta property="og:description" content="Are you a Zotero user? Do you ever wish you could search your libraries by idea not keywords? Then this page is for you. Follow the steps below to download a information from one of your group libraries and search it using an "idea" search. That is, we'll match your search with the semantic content of text from your library. That means you don't have to use the exact language found in a text to find a cite."/>
  	<meta property="og:image" content="images/thefuture.png"/>

  	<meta name="twitter:card" content="summary_large_image">
  	<meta name="twitter:site" content="@Colarusso">
  	<meta name="twitter:creator" content="@Colarusso">
  	<meta name="twitter:title" content="Find My Cite">
  	<meta name="twitter:description" content="Are you a Zotero user? Do you ever wish you could search your libraries by idea not keywords? Then this page is for you. Follow the steps below to download a information from one of your group libraries and search it using an "idea" search. That is, we'll match your search with the semantic content of text from your library. That means you don't have to use the exact language found in a text to find a cite.">
  	<meta name="twitter:image" content="http://www.davidcolarusso.com/images/thefuture.png"/>

    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.16.2/axios.min.js"></script>

    <script type="module" src="https://findmycite.org/js/spin.min.js"></script>

    <link rel="stylesheet" type="text/css" href="css/style.css?build=1">
    <script src="js/find.js"></script>
    <script src="js/ask.js"></script>
    <script src="js/suggest.js"></script>

  </head>
  <body onLoad="tab('none');"><form autocomplete="off">
    <div id="msg" style="display:none;top:0;z-index:100;width:100%;margin:0;">
      <div style="margin:15px auto 0 auto;max-width:400px;text-align:center;background:#fff;padding:0px 15px 0 15px;">
      <p><img id="patience" src="images/patience.gif" style="width:100%"/></p>
      <b> This may take some time. I am currently:</b>
      <p id="output">Thinking...</p>
      </div>
    </div>
    <div id="content" style="margin:15px auto 0 auto;max-width:900px;">

      <div style="float:left;text-align:left"><b>Find My Cite</b> <sup><font color="gray" size=-2>BETA</font></div>
      <div id="menu" style="float:right;display:none;">
        <a id="menu_find" href="javascript:void('');" onClick="tab('find');">Find</a>&nbsp;&nbsp;&nbsp;
        <a id="menu_ask" href="javascript:void('');" onClick="tab('ask');">Ask</a>&nbsp;&nbsp;&nbsp;
        <a id="menu_suggest" href="javascript:void('');" onClick="tab('suggest');">Suggest</a>&nbsp;&nbsp;&nbsp;
        <a id="menu_settings" href="javascript:void('');" onClick="tab('settings');">Settings</a>
      </div>

      <div id="search_box" style="float:left;width:100%;">

        <hr style="height:1px;border:none;color:#999;background-color:#999;margin:15px 0 0 0;">

        <div id="find" style="float:left;width:100%;display:none;">

          <a name="search"><h2>Find a proposition in your <a href="#library" onClick="tab('settings');">library</a></h2></a>

          <div style="float:left;margin-right:45px;margin-bottom:20px;">
            <input type="checkbox" id="suggest" name="suggest" value="1" CHECKED>
            <label for="suggest"> Auto suggest (shows up to 5 matching texts from your library)</label>
          </div>
          <div style="float:left;margin-bottom:20px;">
            Similarity Cutoff: <span id="cutoffv">70</span>%</br>
            <input type="range" min="50" max="100" value="70" id="cutoff" oninput="$('#cutoffv').html(this.value);" style="width:200px;">
          </div>
          <div style="float:left;width:100%;margin:0px 0 0px 0;">
            <table><tr><td width="100%">
              <div class="autocomplete" style="width:100%;">
                <input id="q" type="text" name="q" placeholder="The proposition you wish to cite" style="width:100%;height:43px;font-size:15px;padding:10px;box-sizing: border-box;border-radius: 5px; border: solid 1px #5e5e5e;resize:none;">
              </div>
            </td><td width="50px">
              <input type="button" class="ai_button" style="width:100px;" value='Find' onclick="test_understanding(document.getElementById('q').value)"/>
            </td></tr></table>
            <div id="output" style="float:left;width:100%;">
            <div id="loading" style="display:none;float:left;width:100%;height: 60px; margin: 25px 0;text-align:center;"></div>
            <p id="answer" style="margin:0px;float:left;width:100%;"></p>
            </div>
          </div>
        </div>

        <div id="startup" style="float:left;width:100%;text-align:center;background:yellow;padding:10px 0;margin:15px 0;">
          Loading...
        </div>


        <!---   START ASK   -->
        <div id="ask" style="display:none;float:left;width:100%">

          <a name="ask"><h2>Ask a question of your <a href="#library" onClick="tab('settings');">library</a></h2></a>

          <textarea name='question' id="question" style="width:100%;height:80px;font-size:15px;padding:5px;box-sizing: border-box;border-radius: 5px; border: solid 1px #5e5e5e;resize:none;" maxlength="500" placeholder="Ask your question here"></textarea>

          <div style="padding:5px 0 8px 0;"><span class="subtitle"></span></div>

          <p style="margin:0px 0px 5px 0px;">
            <input type="button" class="ai_button" value="Ask" onCLick="ask($('#question').val());"/>
          </p>

          <div id="output_ask" style="float:left;width:100%;">

            <div id="loading_ask" style="display:none;width:100%;margin:50px auto;text-align:center;">
              <img src="images/Ajax-loader.gif" width="35px;" height="35px;"/>
            </div>
            <div id="response_ask" style="float:left;display:none;width:100%;margin:0px auto 0px 0px;"></div>

          </div>
      </div>
      <!---   END ASK   -->


      <!---   START COMPLET   -->
      <div id="complete" style="display:none;float:left;width:100%;">

        <a name="suggest"><h2>Suggest text supported by your <a href="#library" onClick="tab('settings');">library</a></h2></a>

        <textarea name='seed' id="seed" style="width:100%;height:250px;font-size:15px;padding:5px;box-sizing: border-box;border-radius: 5px; border: solid 1px #5e5e5e;resize:none;" maxlength="500" placeholder="Start a paragraph here"></textarea>

        <div style="padding:5px 0 8px 0;"><span class="subtitle"></span></div>

        <p style="margin:0px 0px 5px 0px;">
          <input type="button" class="ai_button" value="Suggest" onCLick="com_par($('#seed').val());"/>
        </p>

        <div id="output_complete" style="float:left;width:100%;">

          <div id="loading_complete" style="display:none;width:100%;margin:50px auto;text-align:center;">
            <img src="images/Ajax-loader.gif" width="35px;" height="35px;"/>
          </div>
          <div id="response_complete" style="float:left;display:none;width:100%;margin:0px auto 0px 0px;"></div>

        </div>
    </div>
    <!---   END COMPLETE   -->


    <!---   START LIBRARY   -->
    <div id="library" style="display:none;float:left;width:100%">
      <a name="openai"><h2>My Open AI Cedentials</h2></a>
      <p>
        Org ID: <input id="group" style="border:1px solid #aaa;padding:5px;box-sizing: border-box; font-size:15px;" value="placeholder" disabled>
        API-Key: <input id="api_key" style="border:1px solid #aaa;padding:5px;box-sizing: border-box; font-size:15px;" value="placeholder" type="password" disabled/>
      </p>
      <p>
        <select style="padding:5px;font-size:15px;" disabled>
          <option>word2vec (use this instead of a model from OpenAI)</option>
          <option>text-embedding-ada-002</option>
        </select>
        <select style="padding:5px;font-size:15px;" disabled>
          <option>text-davinci-003</option>
        </select>
      </p>

      <a name="library"><h2>My Zotero Library</h2></a>
      <p>
        API-Key: <input id="api_key" style="border:1px solid #aaa;padding:5px;box-sizing: border-box; font-size:15px;" value="placeholder" type="password" disabled/>
        Group: <input id="group" style="border:1px solid #aaa;padding:5px;box-sizing: border-box; font-size:15px;" value="4935168" disabled>
      </p>
      <select id="bib" style="padding:5px;font-size:15px;" disabled>
        <option value="apa">American Psychological Association 7th edition</option>
        <option value="bluebook-law-review" SELECTED>Bluebook Law Review</option>
        <option value="https://our.law.nagoya-u.ac.jp/updater/styles/jm-indigobook-law-review.csl">IndigoBook (Law Review)</option>
        <option value="chicago-note-bibliography">Chicago Manual of Style 17th edition (note)</option>
        <option value="modern-language-association">Modern Language Association 8th edition</option>
      </select>

      <p><input type="button" value="Sync with Library" style="padding:5px;font-size:15px;" disabled /></p>

      <h3>Texts in your library:</h3>
      <p>We can olnly provide information from those texts highlighted in <span style='background:#aef7a6'>light green</span>. You may be able to turn more of them green by doing one of two things: (1) if you don't have a copy of the document in your Zotero library, add it and syncing above; (2) re-building your Zotero library index and syncing above once it is complete. See <a href="https://www.zotero.org/support/preferences/search">Zotero Search</a> (including discussion of how to rebuld your Full-Text Cache)</p>
      <ol id="lib_links">
      </ol>
    </div>
    <!---   END LIBRARY   -->


    <div style="width:100%;float:left;margin-top:20px;">
      <hr style="height:1px;border:none;color:#999;background-color:#999;">
      <p style='text-align:center;margin-bottom:400px;'>
        Site by <a href="https://twitter.com/Colarusso" target="_blank">Colarusso</a> | <a href="https://github.com/colarusso/findmycite" target="_blank">GitHub</a> | <a href="https://suffolklitlab.org/" target="_blank">You may also like</a>
      </p>
    </div>


  </form></body>
  <script>
    function tab(choice){

      if ((choice=="none") && (localStorage.tab)) {
        choice = localStorage.tab;
      } else if (choice=="none") {
        choice = "find";
      }

      localStorage.tab = choice;

      $('#startup').hide();
      $('#menu').show();

      if (choice=="find") {
        $('#library').hide();
        $('#find').show();
        $('#ask').hide();
        $('#complete').hide();
        $('#menu_find').css('text-decoration', 'none');
        $('#menu_find').css('font-weight', '600');
        $('#menu_find').css('color', 'black');
        $('#menu_ask').css('text-decoration', 'underline');
        $('#menu_ask').css('font-weight', '100');
        $('#menu_ask').css('color', 'blue');
        $('#menu_suggest').css('text-decoration', 'underline');
        $('#menu_suggest').css('font-weight', '100');
        $('#menu_suggest').css('color', 'blue');
        $('#menu_settings').css('text-decoration', 'underline');
        $('#menu_settings').css('font-weight', '100');
        $('#menu_settings').css('color', 'blue');
        $('#q').focus();
      } else if (choice=="ask") {
        $('#library').hide();
        $('#find').hide();
        $('#ask').show();
        $('#complete').hide();
        $('#menu_find').css('text-decoration', 'underline');
        $('#menu_find').css('font-weight', '100');
        $('#menu_find').css('color', 'blue');
        $('#menu_ask').css('text-decoration', 'none');
        $('#menu_ask').css('font-weight', '600');
        $('#menu_ask').css('color', 'black');
        $('#menu_suggest').css('text-decoration', 'underline');
        $('#menu_suggest').css('font-weight', '100');
        $('#menu_suggest').css('color', 'blue');
        $('#menu_settings').css('text-decoration', 'underline');
        $('#menu_settings').css('font-weight', '100');
        $('#menu_settings').css('color', 'blue');
        $('#question').focus();
      } else if (choice=="suggest") {
        $('#library').hide();
        $('#find').hide();
        $('#ask').hide();
        $('#complete').show();
        $('#menu_find').css('text-decoration', 'underline');
        $('#menu_find').css('font-weight', '100');
        $('#menu_find').css('color', 'blue');
        $('#menu_ask').css('text-decoration', 'underline');
        $('#menu_ask').css('font-weight', '100');
        $('#menu_ask').css('color', 'blue');
        $('#menu_suggest').css('text-decoration', 'none');
        $('#menu_suggest').css('font-weight', '600');
        $('#menu_suggest').css('color', 'black');
        $('#menu_settings').css('text-decoration', 'underline');
        $('#menu_settings').css('font-weight', '100');
        $('#menu_settings').css('color', 'blue');
        $('#seed').focus();
      } else if (choice=="settings") {
        $('#library').show();
        $('#find').hide();
        $('#ask').hide();
        $('#complete').hide();
        $('#menu_find').css('text-decoration', 'underline');
        $('#menu_find').css('font-weight', '100');
        $('#menu_find').css('color', 'blue');
        $('#menu_ask').css('text-decoration', 'underline');
        $('#menu_ask').css('font-weight', '100');
        $('#menu_ask').css('color', 'blue');
        $('#menu_suggest').css('text-decoration', 'underline');
        $('#menu_suggest').css('font-weight', '100');
        $('#menu_suggest').css('color', 'blue');
        $('#menu_settings').css('text-decoration', 'none');
        $('#menu_settings').css('font-weight', '600');
        $('#menu_settings').css('color', 'black');
      }
    }

    if (localStorage.group) {
      document.getElementById('group').value = localStorage.group;
    }
    if (localStorage.api_key) {
      document.getElementById('api_key').value = localStorage.api_key;
    }
    if (localStorage.cutoff) {
      document.getElementById('cutoff').value = localStorage.cutoff;
      $('#cutoffv').html(localStorage.cutoff);
    }

    $('#q').keypress(function(e){
    if(e.keyCode == 13 && !e.shiftKey && Boolean($('#qautocomplete-list').html()=="" | !$('#qautocomplete-list').html()) ) {
      e.preventDefault();
      test_understanding(document.getElementById('q').value);
     }
    });

    $('#question').keypress(function(e){
    if(e.keyCode == 13 && !e.shiftKey) {
      e.preventDefault();
      ask($('#question').val());
     }
    });

    $('#seed').keypress(function(e){
    if(e.keyCode == 13 && !e.shiftKey) {
      e.preventDefault();
      com_par($('#seed').val());
     }
    });

  </script>
  <script src="js/data_lib.js"></script>
  <script src="js/data_docs.js"></script>
  <script src="js/data_bib.js"></script>
  <script src="js/data_SentTexts.js"></script>
  <script src="js/data_SentVecs_01.js"></script>
  <script src="js/data_SentVecs_02.js"></script>
  <script src="js/data_SentVecs_03.js"></script>
  <script src="js/data_SentVecs_04.js"></script>
  <script src="js/data_SentVecs_05.js"></script>
  <script>
    SentVecs = Object.assign({}, SentVecs_01,SentVecs_02,SentVecs_03,SentVecs_04,SentVecs_05);
    autocomplete(document.getElementById("q"), Object.values(SentTexts));
    for (item in lib) {
    	var linkto = "<a href='https://www.zotero.org/groups/"+lib[item]["library"]["id"]+"/items/"+lib[item]["key"]+"/' target='_blank'>"+lib[item]["citation"]+"</a>";
    	if (lib[item]["hash_id"]) {
    		linkto = "<span style='background:#aef7a6'>"+linkto+"</span>";
    	}
    	$('#lib_links').append("<li>"+linkto+"</li>")
    }
  </script>
</html>
